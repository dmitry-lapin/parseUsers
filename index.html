<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My practice</title>
  <link href="style.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <style>
    
  </style>
</head>

<body class="bg-secondary">
  
  <div class="bg-dark">
    <p class="text-white fs-3 py-2 px-5">List of users</p>
  </div>
  
  
  <div class="container searchBlock bg-dark p-4 rounded border border-primary">
    <p class="text-white fs-3">Enter all usernames that you want to find!</p>
    <p class="text-white fs-5">You need to enter all usernames separated by commas. For example: user1, user2, user3</p>
    <div class="input-group col-6">
      <input type="text" class="form-control text-primary" id="usersField" placeholder="usernames(user, user, user)" aria-label="usernames(user, user, user)" aria-describedby="button-addon2">
      <button class="btn btn-primary" type="button" id="findUsers">Find users!</button>
    </div>
    <div class="form-check text-white mt-2 ms-3">
      <input class="form-check-input" type="checkbox" value="" id="hideNull">
      <label class="form-check-label" for="flexCheckDefault">
        Hide empty or 'null' fields
      </label>
    </div>
  </div>
  
  
  <div id="usersBlock" class="container my-5 rounded"></div>
  
  <script defer>
    
    function displayUser(user, checkHide) {
      let userDiv = document.createElement('div');
      userDiv.classList.add('container', 'user', 'py-3', 'rounded', 'bg-dark', 'my-2', 'px-5', 'd-inline-flex');
      usersBlock.append(userDiv);
      let imgDiv = document.createElement('div');
      imgDiv.classList.add('col-3');
      userDiv.append(imgDiv);
      let userImg = document.createElement('img');
      userImg.classList.add('border','border-primary', 'user_avatar', 'rounded');
      userImg.src = user.avatar_url;
      imgDiv.append(userImg)
      
      //if(checkHide) user = Object.entries(user).filter((key, value) => value != null)
      
      let dataDiv = document.createElement('div');
      dataDiv.classList.add('col-9')
      userDiv.append(dataDiv)
      for(const [param, value] of Object.entries(user)) { 
        if(checkHide && (value != null || value.length > 0)) {
          let pElem = document.createElement('p');
          pElem.classList.add('text-white');
          pElem.innerHTML = `${param}: ${value}`;
          dataDiv.append(pElem);
        }
      }
    }
    
    async function getUsers(names, checkHide) {
      for(let user of names) {
        let url = `https://api.github.com/users/${user}`;
        let request = await fetch(url)
        .then(successStatus => {
          if(successStatus.ok) {
            let response =  successStatus.json()
            .then(answer => JSON.stringify(answer))
            .then(data => displayUser(JSON.parse(data), checkHide));
          }
        }, faultStatus => {
          return null;
        })
      }
    }
    
    let btnFind = document.getElementById('findUsers');
    let usersInput = document.getElementById('usersField')
    btnFind.onclick = function() {
      let checkHide = false;
      if(document.getElementById('hideNull').checked) checkHide = true;
      let users = usersInput.value.replaceAll(' ', '').split(',');
      getUsers(users, checkHide);
    }
  </script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</body>
</html>
